if [[ "$EUID" -eq 0 ]]; then
    echo -e "\nâ›” Running as root user is not allowed."
    echo -e "\nğŸ” This script should be run as a user who has sudo privileges, but *not* using sudo.\n"
    exit 1
fi

# Check if we're inside a QEMU guest
if sudo dmidecode -s system-manufacturer | grep -qi 'QEMU'; then
    echo "âŒâŒâŒ  FATAL: WRONG PLACE, BUDDY! âŒâŒâŒ"
    echo -e "\nâš ï¸ Note:"
    echo -e "  ğŸ”¹ This script is meant to be run on the *host* system managing QEMU/KVM VMs."
    echo -e "  ğŸ”¹ Youâ€™re currently inside a QEMU guest VM, which makes absolutely no sense.\n"
    echo "ğŸ’¥ ABORTING EXECUTION ğŸ’¥"
    exit 1
fi

LAB_ENV_VARS_FILE="/kvm-hub/lab_environment_vars"
if [ -f "$LAB_ENV_VARS_FILE" ]; then
    source "$LAB_ENV_VARS_FILE"
else
    echo -e "\nâŒ Lab environment variables file not found at $LAB_ENV_VARS_FILE\n"
    exit 1
fi