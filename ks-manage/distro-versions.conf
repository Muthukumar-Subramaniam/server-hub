#!/usr/bin/env bash
# Centralized distribution version configuration
# This file defines version mappings for latest and previous releases
#----------------------------------------------------------------------------------------#
# If you encounter any issues with this script, or have suggestions or feature requests, #
# please open an issue at: https://github.com/Muthukumar-Subramaniam/server-hub/issues   #
#----------------------------------------------------------------------------------------#

# Version mappings: distro_base -> latest_version / previous_version
declare -A DISTRO_LATEST_VERSIONS=(
    ["almalinux"]="10"
    ["rocky"]="10"
    ["oraclelinux"]="10"
    ["centos-stream"]="10"
    ["rhel"]="10"
    ["ubuntu-lts"]="24.04"
    ["opensuse-leap"]="15.6"
)

declare -A DISTRO_PREVIOUS_VERSIONS=(
    ["almalinux"]="9"
    ["rocky"]="9"
    ["oraclelinux"]="9"
    ["centos-stream"]="9"
    ["rhel"]="9"
    ["ubuntu-lts"]="22.04"
    ["opensuse-leap"]="15.5"
)

# Display names for interactive menus
declare -A DISTRO_DISPLAY_NAMES=(
    ["almalinux"]="AlmaLinux"
    ["rocky"]="Rocky Linux"
    ["oraclelinux"]="OracleLinux"
    ["centos-stream"]="CentOS Stream"
    ["rhel"]="Red Hat Enterprise Linux"
    ["ubuntu-lts"]="Ubuntu Server LTS"
    ["opensuse-leap"]="openSUSE Leap"
)

# ISO URLs for latest versions
# Note: RHEL URLs are placeholders - actual download requires Red Hat Developer subscription login
declare -A ISO_URLS_LATEST=(
    ["almalinux"]="https://repo.almalinux.org/almalinux/10/isos/x86_64/AlmaLinux-10-latest-x86_64-dvd.iso"
    ["rocky"]="https://dl.rockylinux.org/pub/rocky/10/isos/x86_64/Rocky-10-latest-x86_64-dvd.iso"
    ["oraclelinux"]="https://yum.oracle.com/ISOS/OracleLinux/OL10/u1/x86_64/OracleLinux-R10-U1-x86_64-dvd.iso"
    ["centos-stream"]="https://mirror.stream.centos.org/10-stream/BaseOS/x86_64/iso/CentOS-Stream-10-latest-x86_64-dvd1.iso"
    ["rhel"]="https://developers.redhat.com/content-gateway/file/rhel-10-latest-x86_64-dvd.iso"
    ["ubuntu-lts"]="https://releases.ubuntu.com/24.04/ubuntu-24.04.3-live-server-amd64.iso"
    ["opensuse-leap"]="https://download.opensuse.org/distribution/leap/15.6/iso/openSUSE-Leap-15.6-DVD-x86_64-Media.iso"
)

# ISO URLs for previous versions
declare -A ISO_URLS_PREVIOUS=(
    ["almalinux"]="https://repo.almalinux.org/almalinux/9/isos/x86_64/AlmaLinux-9-latest-x86_64-dvd.iso"
    ["rocky"]="https://dl.rockylinux.org/pub/rocky/9/isos/x86_64/Rocky-9-latest-x86_64-dvd.iso"
    ["oraclelinux"]="https://yum.oracle.com/ISOS/OracleLinux/OL9/u7/x86_64/OracleLinux-R9-U7-x86_64-dvd.iso"
    ["centos-stream"]="https://mirror.stream.centos.org/9-stream/BaseOS/x86_64/iso/CentOS-Stream-9-latest-x86_64-dvd1.iso"
    ["rhel"]="https://developers.redhat.com/content-gateway/file/rhel-9-latest-x86_64-dvd.iso"
    ["ubuntu-lts"]="https://releases.ubuntu.com/22.04/ubuntu-22.04.5-live-server-amd64.iso"
    ["opensuse-leap"]="https://download.opensuse.org/distribution/leap/15.5/iso/openSUSE-Leap-15.5-DVD-x86_64-Media.iso"
)

# ISO filenames for latest versions
declare -A ISO_FILENAMES_LATEST=(
    ["almalinux"]="AlmaLinux-10-latest-x86_64-dvd.iso"
    ["rocky"]="Rocky-10-latest-x86_64-dvd.iso"
    ["oraclelinux"]="OracleLinux-R10-latest-x86_64-dvd.iso"
    ["centos-stream"]="CentOS-Stream-10-latest-x86_64-dvd1.iso"
    ["rhel"]="rhel-10-latest-x86_64-dvd.iso"
    ["ubuntu-lts"]="ubuntu-24.04-latest-live-server-amd64.iso"
    ["opensuse-leap"]="openSUSE-Leap-15.6-DVD-x86_64-Media.iso"
)

# ISO filenames for previous versions
declare -A ISO_FILENAMES_PREVIOUS=(
    ["almalinux"]="AlmaLinux-9-latest-x86_64-dvd.iso"
    ["rocky"]="Rocky-9-latest-x86_64-dvd.iso"
    ["oraclelinux"]="OracleLinux-R9-latest-x86_64-dvd.iso"
    ["centos-stream"]="CentOS-Stream-9-latest-x86_64-dvd1.iso"
    ["rhel"]="rhel-9-latest-x86_64-dvd.iso"
    ["ubuntu-lts"]="ubuntu-22.04-latest-live-server-amd64.iso"
    ["opensuse-leap"]="openSUSE-Leap-15.5-DVD-x86_64-Media.iso"
)

# Helper function to get version number
fn_get_version_number() {
    local distro_base="$1"
    local version_type="$2"  # "latest" or "previous"
    
    if [[ "$version_type" == "latest" ]]; then
        echo "${DISTRO_LATEST_VERSIONS[$distro_base]}"
    else
        echo "${DISTRO_PREVIOUS_VERSIONS[$distro_base]}"
    fi
}

# Helper function to get full display name with version
fn_get_full_display_name() {
    local distro_base="$1"
    local version_type="$2"  # "latest" or "previous"
    
    local display_name="${DISTRO_DISPLAY_NAMES[$distro_base]}"
    local version=$(fn_get_version_number "$distro_base" "$version_type")
    
    echo "$display_name $version"
}
